{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ftc-autoconfig.app/schemas/match-data/v1.0.0",
  "title": "FTC AutoConfig Match Data",
  "description": "Schema for FTC autonomous match configuration data exported from AutoConfig app",
  "type": "object",
  "required": ["version", "matches"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version for backward compatibility",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "default": "1.0.0",
      "examples": ["1.0.0", "1.1.0", "2.0.0"]
    },
    "matches": {
      "type": "array",
      "description": "Array of match configurations",
      "minItems": 0,
      "items": {
        "$ref": "#/definitions/matchWrapper"
      }
    }
  },
  "definitions": {
    "matchWrapper": {
      "type": "object",
      "description": "Wrapper object containing a single match configuration",
      "required": ["match"],
      "properties": {
        "match": {
          "$ref": "#/definitions/match"
        }
      }
    },
    "match": {
      "type": "object",
      "description": "Complete match configuration",
      "required": ["number", "alliance"],
      "properties": {
        "number": {
          "type": "integer",
          "description": "Match number (1-based index)",
          "minimum": 1,
          "examples": [1, 2, 3, 15]
        },
        "alliance": {
          "$ref": "#/definitions/alliance"
        }
      }
    },
    "alliance": {
      "type": "object",
      "description": "Alliance-specific configuration",
      "required": ["color", "team_number", "auto"],
      "properties": {
        "color": {
          "type": "string",
          "description": "Alliance color",
          "enum": ["red", "blue"],
          "examples": ["red", "blue"]
        },
        "team_number": {
          "type": "integer",
          "description": "Partner team number (0 if not specified)",
          "minimum": 0,
          "maximum": 99999,
          "examples": [0, 24180, 12345]
        },
        "auto": {
          "$ref": "#/definitions/autonomous"
        }
      }
    },
    "autonomous": {
      "type": "object",
      "description": "Autonomous configuration including start position and actions",
      "required": ["startPosition", "actions"],
      "properties": {
        "startPosition": {
          "$ref": "#/definitions/startPosition"
        },
        "actions": {
          "type": "array",
          "description": "Sequence of actions to execute during autonomous",
          "items": {
            "$ref": "#/definitions/action"
          },
          "examples": [
            [
              {"type": "near_launch", "label": "Near Launch"},
              {"type": "spike_1", "label": "Spike 1"},
              {"type": "wait", "label": "Wait", "config": {"waitTime": 1000}}
            ]
          ]
        }
      }
    },
    "startPosition": {
      "type": "object",
      "description": "Robot starting position - either a preset or custom coordinates",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "description": "Position type identifier. 'custom' requires x, y, theta fields",
          "minLength": 1,
          "examples": ["front", "back", "left", "right", "custom"]
        },
        "x": {
          "type": "number",
          "description": "X coordinate in field units (required if type is 'custom')",
          "examples": [0, 12.5, -24.0]
        },
        "y": {
          "type": "number",
          "description": "Y coordinate in field units (required if type is 'custom')",
          "examples": [0, 36.0, -12.5]
        },
        "theta": {
          "type": "number",
          "description": "Heading angle in degrees (required if type is 'custom')",
          "minimum": -360,
          "maximum": 360,
          "examples": [0, 90, 180, -90]
        }
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "type": {"const": "custom"}
            }
          },
          "then": {
            "required": ["type", "x", "y", "theta"]
          },
          "else": {
            "required": ["type"]
          }
        }
      ],
      "examples": [
        {"type": "front"},
        {"type": "back"},
        {"type": "custom", "x": 12.5, "y": 24.0, "theta": 90}
      ]
    },
    "action": {
      "type": "object",
      "description": "Single action in the autonomous sequence",
      "required": ["type", "label"],
      "properties": {
        "type": {
          "type": "string",
          "description": "Action type identifier (matches action definition id)",
          "minLength": 1,
          "examples": [
            "near_launch",
            "far_launch",
            "spike_1",
            "spike_2",
            "spike_3",
            "corner",
            "near_park",
            "far_park",
            "dump",
            "drive_to",
            "wait"
          ]
        },
        "label": {
          "type": "string",
          "description": "Human-readable label for the action",
          "minLength": 1,
          "examples": [
            "Near Launch",
            "Spike 1",
            "Park (Near)",
            "Wait",
            "DriveTo"
          ]
        },
        "config": {
          "$ref": "#/definitions/actionConfig"
        }
      },
      "examples": [
        {
          "type": "near_launch",
          "label": "Near Launch"
        },
        {
          "type": "wait",
          "label": "Wait",
          "config": {
            "waitTime": 1000
          }
        },
        {
          "type": "drive_to",
          "label": "DriveTo",
          "config": {
            "x": 24.0,
            "y": 12.0,
            "target": "basket"
          }
        }
      ]
    },
    "actionConfig": {
      "type": "object",
      "description": "Optional configuration parameters for actions. Keys and types are action-specific.",
      "additionalProperties": {
        "anyOf": [
          {"type": "number"},
          {"type": "string"},
          {"type": "boolean"}
        ]
      },
      "examples": [
        {"waitTime": 1000},
        {"x": 24.0, "y": 12.0},
        {"speed": 0.75, "target": "basket"},
        {"duration": 500, "reversed": true}
      ]
    }
  },
  "examples": [
    {
      "version": "1.0.0",
      "matches": [
        {
          "match": {
            "number": 1,
            "alliance": {
              "color": "red",
              "team_number": 24180,
              "auto": {
                "startPosition": {
                  "type": "front"
                },
                "actions": [
                  {
                    "type": "near_launch",
                    "label": "Near Launch"
                  },
                  {
                    "type": "spike_1",
                    "label": "Spike 1"
                  },
                  {
                    "type": "wait",
                    "label": "Wait",
                    "config": {
                      "waitTime": 1000
                    }
                  },
                  {
                    "type": "near_park",
                    "label": "Park (Near)"
                  }
                ]
              }
            }
          }
        },
        {
          "match": {
            "number": 2,
            "alliance": {
              "color": "blue",
              "team_number": 0,
              "auto": {
                "startPosition": {
                  "type": "custom",
                  "x": 12.5,
                  "y": 24.0,
                  "theta": 90
                },
                "actions": [
                  {
                    "type": "far_launch",
                    "label": "Far Launch"
                  },
                  {
                    "type": "drive_to",
                    "label": "DriveTo",
                    "config": {
                      "x": 36.0,
                      "y": 12.0,
                      "target": "basket"
                    }
                  }
                ]
              }
            }
          }
        }
      ]
    }
  ]
}
